{"version":3,"sources":["webpack:///./src/modules/ModelManagement/view/PortDefineEdit.vue?6cd1","webpack:///src/modules/ModelManagement/view/PortDefineEdit.vue","webpack:///./src/modules/ModelManagement/view/PortDefineEdit.vue?f724","webpack:///./src/modules/ModelManagement/view/PortDefineEdit.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","width","title","editMode","visible","on","ok","handleOk","cancel","handleCancel","form","label","directives","name","rawName","value","validateFirst","rules","required","message","validator","portUniquedValidator","pattern","expression","placeholder","_v","allow-clear","mode","not-found-content","_l","optionalVars","varName","key","_s","_withStripped","getRecordFields","vm","port","$form","createFormField","record","type","vars","view_PortDefineEditvue_type_script_lang_js_","props","existPort","Array","default","data","computed","hasOwnProperty","watch","updateFields","created","_this","createForm","mapPropsToFields","methods","_this2","validateFields","err","getFieldsValue","join","$emit","objectSpread_default","clear","rule","callback","indexOf","Error","load","Object","util","$set","_this3","$nextTick","component","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"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","file":"static/js/15.cac41316af6ca0f711f6.js","sourcesContent":["var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"a-modal\",\n    {\n      attrs: {\n        width: 600,\n        title: _vm.editMode ? \"编辑端口\" : \"新增端口\",\n        visible: _vm.visible\n      },\n      on: { ok: _vm.handleOk, cancel: _vm.handleCancel }\n    },\n    [\n      _c(\n        \"a-form\",\n        { attrs: { form: _vm.form } },\n        [\n          _c(\n            \"a-form-item\",\n            { attrs: { label: \"端口编号\" } },\n            [\n              _c(\"a-input\", {\n                directives: [\n                  {\n                    name: \"decorator\",\n                    rawName: \"v-decorator\",\n                    value: [\n                      \"port\",\n                      {\n                        validateFirst: true,\n                        rules: [\n                          { required: true, message: \"请输入端口编号\" },\n                          {\n                            validator: _vm.portUniquedValidator,\n                            message: \"端口名称重复\"\n                          },\n                          {\n                            pattern: /^[A-Za-z][A-Za-z0-9_]*$/,\n                            message: \"端口名称请遵循变量命名\"\n                          }\n                        ]\n                      }\n                    ],\n                    expression:\n                      \"[\\n          'port', \\n          {\\n            validateFirst: true,\\n            rules: [\\n              { required: true, message: '请输入端口编号'}, \\n              { validator: portUniquedValidator, message: '端口名称重复' },\\n              { pattern: /^[A-Za-z][A-Za-z0-9_]*$/, message: '端口名称请遵循变量命名' },\\n            ]\\n          }\\n        ]\"\n                  }\n                ],\n                attrs: { placeholder: \"请输入端口编号\" }\n              })\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"a-form-item\",\n            { attrs: { label: \"端口类型\" } },\n            [\n              _c(\n                \"a-select\",\n                {\n                  directives: [\n                    {\n                      name: \"decorator\",\n                      rawName: \"v-decorator\",\n                      value: [\n                        \"type\",\n                        {\n                          rules: [{ required: true, message: \"请选择端口类型\" }]\n                        }\n                      ],\n                      expression:\n                        \"[\\n          'type',\\n          {rules: [{ required: true, message: '请选择端口类型'}]}\\n        ]\"\n                    }\n                  ],\n                  attrs: { placeholder: \"请选择端口类型\" }\n                },\n                [\n                  _c(\"a-select-option\", { attrs: { value: \"in\" } }, [\n                    _vm._v(\"\\n          输入\\n        \")\n                  ]),\n                  _vm._v(\" \"),\n                  _c(\"a-select-option\", { attrs: { value: \"out\" } }, [\n                    _vm._v(\"\\n          输出\\n        \")\n                  ])\n                ],\n                1\n              )\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"a-form-item\",\n            { attrs: { label: \"端口名称\" } },\n            [\n              _c(\"a-input\", {\n                directives: [\n                  {\n                    name: \"decorator\",\n                    rawName: \"v-decorator\",\n                    value: [\n                      \"name\",\n                      {\n                        rules: [\n                          {\n                            required: true,\n                            message: \"请输入端口名称\"\n                          }\n                        ]\n                      }\n                    ],\n                    expression:\n                      \"[\\n          'name', \\n          {rules: [{ \\n            required: true, message: '请输入端口名称'}\\n          ]}\\n        ]\"\n                  }\n                ],\n                attrs: { placeholder: \"请输入端口名称\" }\n              })\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"a-form-item\",\n            { attrs: { label: \"可用变量\" } },\n            [\n              _c(\n                \"a-select\",\n                {\n                  directives: [\n                    {\n                      name: \"decorator\",\n                      rawName: \"v-decorator\",\n                      value: [\"vars\"],\n                      expression: \"[\\n          'vars',\\n        ]\"\n                    }\n                  ],\n                  attrs: {\n                    \"allow-clear\": \"\",\n                    mode: \"multiple\",\n                    \"not-found-content\": \"查无变量\",\n                    placeholder: \"请选择端口变量\"\n                  }\n                },\n                _vm._l(_vm.optionalVars, function(varName) {\n                  return _c(\"a-select-option\", { key: varName }, [\n                    _vm._v(\"\\n          \" + _vm._s(varName) + \"\\n        \")\n                  ])\n                }),\n                1\n              )\n            ],\n            1\n          )\n        ],\n        1\n      )\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<template>\n  <a-modal\n    :width=\"600\"\n    :title=\"editMode ? '编辑端口' : '新增端口'\"\n    :visible=\"visible\"\n    @ok=\"handleOk\"\n    @cancel=\"handleCancel\"\n  >\n    <a-form :form=\"form\">\n      <a-form-item\n        label=\"端口编号\"\n      >\n        <a-input\n          v-decorator=\"[\n            'port', \n            {\n              validateFirst: true,\n              rules: [\n                { required: true, message: '请输入端口编号'}, \n                { validator: portUniquedValidator, message: '端口名称重复' },\n                { pattern: /^[A-Za-z][A-Za-z0-9_]*$/, message: '端口名称请遵循变量命名' },\n              ]\n            }\n          ]\"\n          placeholder=\"请输入端口编号\"\n        />\n      </a-form-item>\n\n      <a-form-item\n        label=\"端口类型\"\n      >\n        <a-select\n          v-decorator=\"[\n            'type',\n            {rules: [{ required: true, message: '请选择端口类型'}]}\n          ]\"\n          placeholder=\"请选择端口类型\"\n        >\n          <a-select-option value=\"in\">\n            输入\n          </a-select-option>\n          <a-select-option value=\"out\">\n            输出\n          </a-select-option>\n        </a-select>\n      </a-form-item>\n      <a-form-item\n        label=\"端口名称\"\n      >\n        <a-input\n          v-decorator=\"[\n            'name', \n            {rules: [{ \n              required: true, message: '请输入端口名称'}\n            ]}\n          ]\"\n          placeholder=\"请输入端口名称\"\n        />\n      </a-form-item>\n      <a-form-item\n        label=\"可用变量\"\n      >\n        <a-select \n          v-decorator=\"[\n            'vars',\n          ]\"\n          allow-clear\n          mode=\"multiple\"\n          not-found-content=\"查无变量\"\n          placeholder=\"请选择端口变量\"\n        >\n          <a-select-option\n            v-for=\"varName in optionalVars\"\n            :key=\"varName\"\n          >\n            {{ varName }}\n          </a-select-option>\n        </a-select>\n      </a-form-item>\n    </a-form>\n  </a-modal>\n</template>\n\n<script>\nimport { split2array } from '@/lib/util';\n\n/**\n * 构建表单字段映射\n */\nfunction getRecordFields (vm) {\n  return {\n    port: vm.$form.createFormField({value: vm.record.port}),\n    type: vm.$form.createFormField({value: vm.record.type}),\n    name: vm.$form.createFormField({value: vm.record.name}),\n    vars: vm.$form.createFormField({value: vm.record.vars}),\n  }\n}\nexport default {\n  /**\n   * 端口定义的编辑窗口\n   */\n  name: 'PortDefineEdit',\n  props: {\n    /**\n     * 已有端口名称集合\n     */\n    existPort: {\n      type: Array,\n      default: () => ([])\n    },\n    /**\n     * 可供选择的变量集合\n     */\n    optionalVars: {\n      type: Array,\n      default: () => ([])\n    }\n  },\n  data () {\n    return {\n      /**\n       * 表单数据\n       */\n      record: {},\n      /**\n       * 弹出窗是否可见，默认`false`\n       */\n      visible: false,\n    }\n  },\n  computed: {\n    /**\n     * 动态标题，若传入数据为空，则表示**新增**，反之表示**编辑**\n     */\n    editMode () {\n      return this.record.hasOwnProperty('name');\n    },\n  },\n  watch: {\n    record () {\n      // 更新映射\n      this.form.updateFields(getRecordFields(this));\n    }\n  },\n  created () {\n    this.form = this.$form.createForm(this, {\n      // 将`record`值映射到表单\n      mapPropsToFields: () => getRecordFields(this)\n    })\n  },\n  methods: {\n    /**\n     * 确认\n     */\n    handleOk () {\n      this.form.validateFields(err => {\n        if (!err) {\n          const data = this.form.getFieldsValue();\n          data.vars = data.vars.join(',');\n          this.visible = false;\n          this.$emit('update', {...this.record, ...data});\n          this.clear();\n        }\n      });\n    },\n    /**\n     * 取消\n     */\n    handleCancel () {\n      this.visible = false;\n      this.clear();\n    },\n    /**\n     * 验证端口唯一性，不允许重复，且必须为英文\n     */\n    portUniquedValidator (rule, value, callback) {\n      // 发现重名，则提出错误信息\n      if (~this.existPort.indexOf(value) && value != this.record.port) {\n        callback(new Error());\n      }\n      callback();\n    },\n    /**\n     * 动态加载外部数据\n     */\n    load (data) {\n      const vars = split2array(',', data.vars);\n      this.$set(this, 'record', {\n        ...data,\n        vars,\n      });\n      this.visible = true;\n    },\n    /**\n     * 清除表单数据\n     */\n    clear () {\n      this.$nextTick(() => {\n        this.$set(this, 'record', {});\n      })\n    },\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n\n</style>\n\n","import mod from \"-!../../../../node_modules/happypack/loader.js?id=happybabel!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PortDefineEdit.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/happypack/loader.js?id=happybabel!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PortDefineEdit.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PortDefineEdit.vue?vue&type=template&id=78b6a3dc&scoped=true&\"\nimport script from \"./PortDefineEdit.vue?vue&type=script&lang=js&\"\nexport * from \"./PortDefineEdit.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"78b6a3dc\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/loong/gitlab/vsee-cloud/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('78b6a3dc', component.options)\n    } else {\n      api.reload('78b6a3dc', component.options)\n    }\n    module.hot.accept(\"./PortDefineEdit.vue?vue&type=template&id=78b6a3dc&scoped=true&\", function () {\n      api.rerender('78b6a3dc', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/modules/ModelManagement/view/PortDefineEdit.vue\"\nexport default component.exports"],"sourceRoot":""}