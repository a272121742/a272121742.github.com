{"version":3,"sources":["webpack:///./src/modules/ModelManagement/view/PortDefine.vue?7df4","webpack:///src/modules/ModelManagement/view/PortDefine.vue","webpack:///./src/modules/ModelManagement/view/PortDefine.vue?64b4","webpack:///./src/modules/ModelManagement/view/PortDefine.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","attrs","exist-port","existPort","optional-vars","optionalVars","on","update","portDefineUpdate","_v","directives","name","rawName","value","el","onEnd","handleDragEnd","handle","expression","row-key","r","i","columns","data-source","data","pagination","scroll","y","size","bordered","scopedSlots","_u","key","fn","vars","_l","getVarsArray","v","color","_s","text","record","index","editable","click","handleEdit","type","handleRemove","staticStyle","cursor","undefined","slot","handleAdd","_withStripped","PortDefinevue_type_script_lang_js_","components","PortDefineEdit","__webpack_require__","e","then","bind","props","Boolean","default","dataSource","Array","selectedRow","computed","Object","map","prop","watch","immediate","handler","refresh","created","methods","$set","sortBy","toConsumableArray_default","updated","$emit","push","$refs","editForm","load","order","length","$delete","_this","from","oldIndex","to","newIndex","isRise","begin","end","forEach","util","title","dataIndex","customRender","width","slots","view_PortDefinevue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"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","file":"static/js/14.451ea09a471e480e7e5e.js","sourcesContent":["var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    [\n      _c(\"port-define-edit\", {\n        ref: \"editForm\",\n        attrs: {\n          \"exist-port\": _vm.existPort,\n          \"optional-vars\": _vm.optionalVars\n        },\n        on: { update: _vm.portDefineUpdate }\n      }),\n      _vm._v(\" \"),\n      _c(\n        \"a-table\",\n        {\n          directives: [\n            {\n              name: \"sortable\",\n              rawName: \"v-sortable\",\n              value: {\n                el: \".ant-table-wrapper .ant-table-body table .ant-table-tbody\",\n                onEnd: _vm.handleDragEnd,\n                handle: \".anticon-drag\"\n              },\n              expression:\n                \"{el: '.ant-table-wrapper .ant-table-body table .ant-table-tbody', onEnd: handleDragEnd, handle: '.anticon-drag'}\"\n            }\n          ],\n          attrs: {\n            \"row-key\": function(r, i) {\n              return i\n            },\n            columns: _vm.columns,\n            \"data-source\": _vm.data,\n            pagination: false,\n            scroll: { y: 240 },\n            size: \"small\",\n            bordered: \"\"\n          },\n          scopedSlots: _vm._u(\n            [\n              {\n                key: \"vars\",\n                fn: function(vars) {\n                  return _vm._l(_vm.getVarsArray(vars), function(v) {\n                    return _c(\"a-tag\", { key: v, attrs: { color: \"blue\" } }, [\n                      _vm._v(\"\\n        \" + _vm._s(v) + \"\\n      \")\n                    ])\n                  })\n                }\n              },\n              {\n                key: \"operation\",\n                fn: function(text, record, index) {\n                  return _vm.editable\n                    ? [\n                        _c(\n                          \"a\",\n                          {\n                            on: {\n                              click: function() {\n                                return _vm.handleEdit(index, record)\n                              }\n                            }\n                          },\n                          [_c(\"a-icon\", { attrs: { type: \"edit\" } })],\n                          1\n                        ),\n                        _vm._v(\" \"),\n                        _c(\n                          \"a\",\n                          {\n                            on: {\n                              click: function() {\n                                return _vm.handleRemove(index)\n                              }\n                            }\n                          },\n                          [_c(\"a-icon\", { attrs: { type: \"delete\" } })],\n                          1\n                        ),\n                        _vm._v(\" \"),\n                        _c(\n                          \"a\",\n                          { staticStyle: { cursor: \"move\" } },\n                          [_c(\"a-icon\", { attrs: { type: \"drag\" } })],\n                          1\n                        )\n                      ]\n                    : undefined\n                }\n              }\n            ],\n            null,\n            true\n          )\n        },\n        [\n          _c(\"template\", { slot: \"operationTitle\" }, [\n            _vm.editable\n              ? _c(\n                  \"a\",\n                  { on: { click: _vm.handleAdd } },\n                  [_c(\"a-icon\", { attrs: { type: \"plus\" } })],\n                  1\n                )\n              : _c(\"div\", [_vm._v(\"\\n        操作\\n      \")])\n          ])\n        ],\n        2\n      )\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <!-- 编辑表单（弹出）-->\n    <port-define-edit\n      ref=\"editForm\"\n      :exist-port=\"existPort\"\n      :optional-vars=\"optionalVars\"\n      @update=\"portDefineUpdate\"\n    ></port-define-edit>\n    <!-- 可排序表格-->\n    <a-table\n      v-sortable=\"{el: '.ant-table-wrapper .ant-table-body table .ant-table-tbody', onEnd: handleDragEnd, handle: '.anticon-drag'}\"\n      :row-key=\"(r, i) => i\"\n      :columns=\"columns\"\n      :data-source=\"data\"\n      :pagination=\"false\"\n      :scroll=\"{ y: 240 }\"\n      size=\"small\"\n      bordered\n    >\n      <!-- 自定义标题（操作栏） -->\n      <template\n        slot=\"operationTitle\"\n      >\n        <a\n          v-if=\"editable\"\n          @click=\"handleAdd\"\n        ><a-icon type=\"plus\" /></a>\n        <div v-else>\n          操作\n        </div>\n      </template>\n      <!-- 变量标签 -->\n      <template\n        slot=\"vars\"\n        slot-scope=\"vars\"\n      >\n        <a-tag\n          v-for=\"v in getVarsArray(vars)\"\n          color=\"blue\"\n          :key=\"v\"\n        >\n          {{ v }}\n        </a-tag>\n      </template>\n      <template\n        v-if=\"editable\"\n        slot=\"operation\"\n        slot-scope=\"text, record, index\"\n      >\n        <a\n          @click=\"() => handleEdit(index, record)\"\n        ><a-icon type=\"edit\" /></a>\n        <a\n          @click=\"() => handleRemove(index)\"\n        ><a-icon type=\"delete\" /></a>\n        <a\n          style=\"cursor:move;\"\n        ><a-icon type=\"drag\" /></a>\n      </template>\n    </a-table>\n  </div>\n</template>\n\n<script>\nimport { map, prop, move, sortBy } from 'ramda';\nimport { split2array } from '@lib/util';\n/**\n * 端口定义的表格组件\n * 组件模式：\n *  1. 外部将字符串数据传入组件内部，渲染成数组\n *  2. 数组列表进行增删改的操作后，触发上层组件的`update`事件\n */\nexport default {\n  name: 'PortDefined',\n  components: {\n    PortDefineEdit: () => import('./PortDefineEdit.vue')\n  },\n  props: {\n    /**\n     * 是否可编辑，默认false\n     */\n    editable: {\n      type: Boolean,\n      default: true\n    },\n    /**\n     * 传入的标准列表数据源，无需像上面一样转换\n     */\n    dataSource: {\n      type: Array,\n      default: () => ([])\n    },\n    /**\n     * 可选变量（字符串）\n     */\n    optionalVars: {\n      type: Array,\n      default: () => ([])\n    }\n  },\n  data () {\n    return {\n      // 表格列信息\n      columns: columns,\n      // 表格数据\n      data: [],\n      // 操作行\n      selectedRow: -1\n    }\n  },\n  computed: {\n    /**\n     * 动态获取存在的端口名称，用于向`端口编辑`的弹窗组件传递约束参数。\n     * 端口编辑窗口中，端口名称必须唯一。\n     */\n    existPort () {\n      return map(prop('port'), this.data)\n    },\n  },\n  watch: {\n    dataSource: {\n      immediate: true,\n      handler () {\n        this.refresh();\n      }\n    }\n  },\n  created () {\n    \n  },\n  methods: {\n    /**\n     * 数据刷新，数据由上层组件字符串向下传递获得并对列表按照字段`order`进行排序\n     */\n    refresh () {\n      this.$set(this, 'data', sortBy(prop('order'), [...this.dataSource]));\n    },\n    /**\n     * 内部数据更新结束\n     */\n    updated () {\n      // 将数据发送给上层组件\n      this.$emit('update', [...this.data]);\n    },\n    /**\n     * 端口发生变化时，调用此方法：\n     * 1. 端口新增时被调用，`this.selectedRow = -1`;\n     * 2. 端口修改时被调用，`this.selectedRow > -1`;\n     */\n    portDefineUpdate (record) {\n      ~this.selectedRow ? \n        this.$set(this.data, this.selectedRow, record) : \n        this.data.push(record);\n      this.updated();\n    },\n    // UI: 添加操作\n    handleAdd () {\n      this.selectedRow = -1;\n      this.$refs.editForm.load({order: this.data.length + 1});\n    },\n    // UI: 启用编辑模式\n    handleEdit (index, record) {\n      this.selectedRow = index;\n      this.$refs.editForm.load(record);\n    },\n    // UI: 删除操作\n    handleRemove (index) {\n      this.$delete(this.data, index);\n      this.updated();\n    },\n    /**\n     * UI: 拖拽结束后，重新设置排序属性\n     */\n    handleDragEnd (e) {\n      const from = e.oldIndex;\n      const to = e.newIndex;\n      // 是否从小到大？\n      const isRise = from < to;\n      // 如果是从小到大，那么起始值是`from`，否则是`to`;\n      const begin = isRise ? from : to;\n      // 如果是从小到大，那么终止值是`to`，否则是`from`;\n      const end = isRise ? to : from;\n      this.data.forEach((record) => {\n        const { order } = record;\n        // 只调整`[begin, end]`中间段的排序数据\n        if (begin + 1 <= order && order <= end + 1) {\n          // 起始点直接拖到终点\n          if (order === from + 1) {\n            this.$set(record, 'order', to + 1);\n          } else {\n            // 如果是从小拖到大，则中间段-1，如果是从大拖到小，则中间段+1\n            this.$set(record, 'order', order + (isRise ? -1 : 1));\n          }\n        }\n      });\n    },\n    getVarsArray (vars) {\n      return split2array(',', vars);\n    }\n  }\n};\n// 列信息\nconst columns = [{\n  title: '#',\n  dataIndex: 'order',\n  scopedSlots: { customRender: 'order' },\n  width: 24,\n},{\n  title: '端口',\n  dataIndex: 'port',\n  scopedSlots: { customRender: 'port' },\n  width: 80,\n}, {\n  title: '类型',\n  dataIndex: 'type',\n  scopedSlots: { customRender: 'type' },\n  width: 80,\n}, {\n  title: '名称',\n  dataIndex: 'name',\n  scopedSlots: { customRender: 'name' },\n  width: 80,\n}, {\n  title: '变量',\n  dataIndex: 'vars',\n  scopedSlots: { customRender: 'vars' },\n}, {\n  dataIndex: 'operation',\n  slots: { title: 'operationTitle' },\n  scopedSlots: { customRender: 'operation' },\n  width: 68\n}];\n</script>\n\n<style lang=\"less\" scoped>\n</style>\n","import mod from \"-!../../../../node_modules/happypack/loader.js?id=happybabel!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PortDefine.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/happypack/loader.js?id=happybabel!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PortDefine.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PortDefine.vue?vue&type=template&id=90adf89c&scoped=true&\"\nimport script from \"./PortDefine.vue?vue&type=script&lang=js&\"\nexport * from \"./PortDefine.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"90adf89c\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Users/loong/gitlab/vsee-cloud/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('90adf89c', component.options)\n    } else {\n      api.reload('90adf89c', component.options)\n    }\n    module.hot.accept(\"./PortDefine.vue?vue&type=template&id=90adf89c&scoped=true&\", function () {\n      api.rerender('90adf89c', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/modules/ModelManagement/view/PortDefine.vue\"\nexport default component.exports"],"sourceRoot":""}